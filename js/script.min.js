/*!
 * Crypto Exhibit v1.0.0-alpha (http://www.crypto-exhib.it)
 * Copyright 2018 Mannheim University of Applied Sciences, Kristian Kraljic
 * Licensed under  ()
 */
var BigInteger=forge.jsbn.BigInteger;Array.sliceArguments=function(e){return Array.prototype.slice.apply(e,Array.prototype.slice.call(arguments,1))},Array.spliceArguments=function(e){var t=jQuery.makeArray(e);return Array.prototype.splice.apply(t,Array.sliceArguments(arguments,1)),t},Array.concatArguments=function(e){return Array.prototype.concat.apply(jQuery.makeArray(e),Array.sliceArguments(arguments,1))},String.prototype.format=function(){var r=arguments;return this.replace(/\$(\d+)/g,function(e,t){return void 0!==r[t-1]?r[t-1]:e})},String.prototype.rot=function(t){return this.replace(/[a-zA-Z]/g,function(e){return String.fromCharCode((e<="Z"?90:122)>=(e=e.charCodeAt(0)+(t%26+26)%26)?e:e-26)})};var steps=function(e){return{algorithm:e=1,input:++e,parameters:++e,execute:++e,output:++e}}();function elementId(e,t){if("string"==typeof e)return elementId.apply(this,Array.spliceArguments(arguments,0,0,0));var r=jQuery.reduce(Array.sliceArguments(arguments,2),function(e,t){return t?e+"-"+t:e},t);return e?"$2\\[$1\\]".format(e,r):r}function elementsSelector(e,t){if("string"==typeof e)return elementsSelector.apply(this,Array.spliceArguments(arguments,0,0,0));var r=['[id|="$1"]'.format(t)];return e&&r.push('[id$="[$1]"]'.format(e)),jQuery.each(Array.sliceArguments(arguments,2),function(e,t){t&&r.push(/^:/.test(t)?t:'[id*="-$1"]'.format(t))}),r.join(String())}function matchElementId(e){return/(.+)\[(\d+)\]/.exec(e)}function parameterValue(e,t,r){var n=jQuery.parameter(e,t,r);return"TEXTAREA"==n.prop("tagName")?convert(n.val()).from(getMode(e,matchElementId(n.attr("id"))[1])).to("text"):"checkbox"==n.attr("type")?n.is(":checked"):n.val()}function randomBytes(e){return convert(forge.random.getBytesSync(e)).from("text").to("hex")}function randomPrime(e){return jQuery.Deferred(function(r){forge.prime.generateProbablePrime(e,function(e,t){e?r.reject(e):r.resolve(t.toString())})}).promise()}function rsaRandomE(o){return jQuery.Deferred(function(a){!function e(){var t=jQuery.parameter(o,"rsa","p").val(),r=jQuery.parameter(o,"rsa","q").val();if(t&&r){var n=new BigInteger(t).multiply(new BigInteger(r));a.resolve(n.toString())}else setTimeout(e,50)}()}).promise()}function convert(n){"functions"in convert||(convert.functions={hex:{dec:function(e){return new BigInteger(e.replace(/ /g,String()),16).toString()},text:function(e){return forge.util.hexToBytes(e.replace(/[^0-9A-F]/gi,String()))}},dec:{hex:function(e){return convert(new BigInteger(e).toString(16)).to("hex")},text:function(e){return convert(e).from("dec").to("hex","text")}},text:{hex:function(e){return convert(forge.util.bytesToHex(e)).to("hex")},dec:function(e){return convert(e).from("text").to("hex","dec")}},false:{hex:function(e){return e.replace(/[^0-9A-F]/gi,String()).replace(/(.{2})/g,"$1 ").trim().toUpperCase()},dec:function(e){return e.replace(/[^0-9]/g,String()).trim()},text:function(e){return e}}});var t=function(r){return{to:function(){return jQuery.each(arguments,function(e,t){r!=t&&(n=convert.functions[r][t](n),r=t)}),n}}};return{from:function(e){return t(e)},to:t(!1).to}}function toggleEncryptDecrypt(e){jQuery.element(e,"encryptdecrypt").find("span").text(jQuery.element(e,"encrypt").prop("checked")?"Encrypt":"Decrypt")}function getAlgorithm(e){return jQuery.element(e,"algorithm").val()}function getMode(e,t){return jQuery("input[name=$1]:checked".format(elementId.apply(this,Array.concatArguments(arguments,"mode")))).val()}function changeMode(e,t,r){if(arguments.length<3)return changeMode(e,t,getMode(e,t));var n=jQuery.element.apply(this,Array.spliceArguments(arguments,arguments.length-1)),a=n.next("div"),o=a.find('input[type="radio"][id*="-$1"]'.format(r)),u=a.data("mode")||"text";o.prop("checked",!0),a.data("mode",r),n.val(convert(n.val()).from(u).to(r)),n.toggleClass("text-monospace","hex"==r)}function convertEditor(e,t){var r=jQuery.element.apply(this,arguments);r.val(convert(r.val()).to(getMode.apply(this,arguments)))}function editorValue(e,t){return convert(jQuery.element.apply(this,arguments).val()).from(getMode.apply(this,arguments)).to("text")}function toggleCompare(e,t){arguments.length<2&&(t=e,e=!jQuery.elements(2,"step",steps.algorithm,":visible").length),jQuery("#compare i").removeClass("fa-plus-circle fa-minus-circle").addClass("fa-$1-circle".format(e?"minus":"plus")),jQuery("#compare a").text(e?"Hide the comparison tab.":"Add another tab to compare."),jQuery.element(2,"step",steps.algorithm).revealOrConceal(e,t),e?stepInput(2,steps.algorithm):toggleStep(2,steps.algorithm,!1,t)}function toggleStep(e,t,r,n){r&&"string"!=typeof r?(jQuery.element(e,"step",t+1).reveal(n),jQuery.element(e,"dummy",t+1).conceal(),jQuery.element("help",t+1).reveal(n),stepInput(e,t+1)):(jQuery.elements(e,"step",":"+(r||"gt")+"("+(t-1)+")").conceal(n).promise().done(function(){jQuery.elements(e,"dummy",":"+(r||"gt")+"("+(t-1)+")").reveal()}),jQuery.elements("help",":"+(r||"gt")+"("+Math.max(t-1,jQuery.elements(e%2+1,"step",":visible").length-1)+")").conceal(n))}function toggleParameters(tab,algorithm,animate){var parameters=jQuery.parameter(tab,algorithm,!0);(parameters=jQuery.parameter(tab,algorithm,!0)).length?(animate=jQuery.parameter(tab).filter(":visible").length&&animate,jQuery.parameter(tab,!0).conceal(animate).promise().done(function(){parameters.each(function(){var parameter=jQuery(this).find("[data-value]:input"),value;!parameter.val()&&(value=parameter.data("value"))&&(/(.*)$/i.test(value)&&jQuery.isFunction((value=eval(value)||String()).promise)?value.then(function(e){parameter.val(e)}):parameter.val(value))}).reveal(animate)})):toggleStep(tab,steps.parameters,"eq",animate)}function toggleHelp(e,t,r){var n={reveal:'[data-help="all"], [data-help="'+t+'"]',conceal:'[data-help][data-help!="all"][data-help!="'+t+'"]'};jQuery.when.apply(this,[jQuery(n.conceal).conceal(r).promise()].concat(jQuery.elements("help").map(function(){return jQuery(this).children(n.reveal).filter(":gt(2)").stop().conceal(r).promise()}))).done(function(){jQuery.elements("help").each(function(){var e=jQuery(this);e.children(n.reveal).filter(":lt(3)").reveal(r),e.children("button").revealOrConceal(!!e.children(n.reveal).filter(":gt(2)").length,r)})})}function showMore(e){jQuery.element("help",e).children("button").conceal(!0).end().children('[data-help="all"], [data-help="'+getAlgorithm()+'"]').reveal(!0)}function stepInput(e,t){var r=!1,n=getAlgorithm(e);switch(t){case steps.algorithm:toggleParameters(e,n,!0),toggleHelp(e,n,!0),(r=!!n)&&setTimeout(function(){stepInput(e,steps.input)},500);break;case steps.input:if((r=!!jQuery.element(e,"input").val())&&!jQuery.parameter(e,n,!0).length)return void stepInput(e,t+1);break;case steps.parameters:r=jQuery.parameter(e,n).reduce(function(e){return e&&!!jQuery(this).val()},!0);break;case steps.execute:r=!!jQuery.element(e,"output").val();break;case steps.output:r=!0}toggleStep(e,t,r,!0)}function encryptDecrypt(e){var t,r,n=jQuery.element(e,"encrypt").prop("checked"),a=editorValue(e,"input"),o=String();switch(changeMode(e,"output",r="dec"!=getMode(e,"input")?n?"hex":"text":"dec"),t=getAlgorithm(e)){case"aes":case"des":var u=parameterValue(e,t,"key"),i=parameterValue(e,t,"iv");(l=(n?forge.cipher.createCipher:forge.cipher.createDecipher)(("des"==t&&parameterValue(e,t,"triple")?"3":String())+t.toUpperCase()+"-"+parameterValue(e,t,"mode"),u)).start({iv:i}),l.update(forge.util.createBuffer(a)),l.finish()&&(o=convert(l.output).from("text").to(r));break;case"rc2":var l;u=parameterValue(e,t,"key"),i=parameterValue(e,t,"iv");(l=(n?forge.rc2.createEncryptionCipher:forge.rc2.createDecryptionCipher)(u)).start(i),l.update(forge.util.createBuffer(a)),l.finish()&&(o=convert(l.output).from("text").to(r));break;case"rot":changeMode(e,"output","text"),o=a.rot(parseInt(parameterValue(e,t,"places")))}jQuery.element(e,"output").val(o)}jQuery.reduce=function(e,r,n){return n=void 0===n?0:n,jQuery.each(e,function(e,t){n=r.call(this,n,t,e)}),n},jQuery.fn.reduce=function(e,t){return jQuery.reduce(this,e,t)},jQuery.fn.reveal=function(e){return this.fadeIn(e?null:0)},jQuery.fn.conceal=function(e){return this.fadeOut(e?"fast":0,function(){jQuery(this).attr("style","display:none!important")})},jQuery.fn.revealOrConceal=function(e,t){e?this.reveal(t):this.conceal(t)},jQuery.element=function(e,t){return jQuery("#"+elementId.apply(this,arguments))},jQuery.elements=function(e,t){return jQuery(elementsSelector.apply(this,arguments))},jQuery.parameter=function(e,t,r,n){return"boolean"==typeof t&&(r=t,t=null),"boolean"==typeof r&&(n=r,r=null),r?jQuery.element(e,!0!==n?"parameter":"group",t,r):jQuery.elements(e,n?"group":"parameter",t,!0!==n?":input":null)},function(e){"use strict";e(document).ready(function(){toggleStep(1,1,!1),toggleStep(2,1,!1),toggleCompare(!1,!1),toggleHelp(1,null,!1),jQuery("textarea[data-mode]").each(function(){var e=jQuery(this),t=matchElementId(e.attr("id"));changeMode(parseInt(t[2]),t[1],e.data("mode"))}),jQuery(".container>.row").hide().removeClass("d-none").reveal(!0)}),e('[data-toggle="popover"]').popover()}(jQuery);