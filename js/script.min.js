/*!
 * Crypto Exhibit v1.0.0-alpha (http://www.crypto-exhib.it)
 * Copyright 2018 Mannheim University of Applied Sciences, Kristian Kraljic
 * Licensed under  ()
 */
var BigInteger=forge.jsbn.BigInteger;function randomBytes(e){return convert(forge.random.getBytesSync(e)).from("text").to("hex")}function randomPrime(e){return jQuery.Deferred(function(r){forge.prime.generateProbablePrime(e,function(e,t){e?r.reject(e):r.resolve(t.toString())})}).promise()}function rsaRandomE(o){return jQuery.Deferred(function(a){!function e(){var t=jQuery.parameter(o,"rsa","p").val(),r=jQuery.parameter(o,"rsa","q").val();if(t&&r){var n=new BigInteger(t).multiply(new BigInteger(r));a.resolve(n.toString())}else setTimeout(e,50)}()}).promise()}function convert(n){"functions"in convert||(convert.functions={hex:{text:function(e){var t=[];if(!(e=e.replace(/[^0-9A-F]/gi,String()))||/^0+$/.test(e))return String();for(var r=0,n=e.length;r<n;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join(String())},dec:function(e){return new BigInteger(e.replace(/ /g,String()),16).toString()}},dec:{hex:function(e){return convert(new BigInteger(e).toString(16)).to("hex")},text:function(e){return convert(e).from("dec").to("hex","text")}},text:{hex:function(e){for(var t=[],r=0,n=e.length;r<n;r++)t.push(("0"+Number(e.charCodeAt(r)).toString(16)).substr(-2));return t.join(" ").toUpperCase()},dec:function(e){return convert(e).from("text").to("hex","dec")}},false:{hex:function(e){return e.replace(/[^0-9A-F]/gi,String()).replace(/(.{2})/g,"$1 ").trim().toUpperCase()},dec:function(e){return e.replace(/[^0-9]/g,String()).trim()},text:function(e){return e}}});var t=function(r){return{to:function(){return jQuery.each(arguments,function(e,t){r!=t&&(n=convert.functions[r][t](n),r=t)}),n}}};return{from:function(e){return t(e)},to:t(!1).to}}jQuery.reduce=function(e,r,n){return n=void 0===n?0:n,jQuery.each(e,function(e,t){n=r.call(this,n,t,e)}),n},jQuery.fn.reduce=function(e,t){return jQuery.reduce(this,e,t)},jQuery.fn.reveal=function(e){return this.fadeIn(e?null:0)},jQuery.fn.conceal=function(e){return this.fadeOut(e?"fast":0,function(){jQuery(this).attr("style","display:none!important")})},jQuery.fn.revealOrConceal=function(e,t){e?this.reveal(t):this.conceal(t)},jQuery.id=function(e,t,r){return(arguments.length<3?t:r+t)+"-"+e},jQuery.element=function(e,t,r){return jQuery("#"+jQuery.id.apply(this,arguments))},jQuery.parameter=function(e,t,r,n){"boolean"==typeof t&&(r=t,t=null),"boolean"==typeof r&&(n=r,r=null);var a=n?"group":"parameter";return t&&r?jQuery.element(e,a+[t,r].join("_")):jQuery('[id^="'+a+(t?t+"_":String())+'"][id$="-'+e+'"]'+(n?String():":input"))},function(e){"use strict";e(document).ready(function(){toggleStep(1,1,!1),toggleStep(2,1,!1),toggleCompare(!1,!1),toggleHelp(1,null,!1),jQuery("textarea[data-mode]").each(function(){var e=jQuery(this).attr("id").split("-");changeMode(e[1],e[0],jQuery(this).data("mode"))})}),e('[data-toggle="popover"]').popover()}(jQuery);var steps=function(e){return{algorithm:e=1,input:++e,parameters:++e,execute:++e,output:++e}}();function toggleEncryptDecrypt(e){jQuery.element(e,"encryptdecrypt").find("span").text(jQuery.element(e,"encrypt").prop("checked")?"Encrypt":"Decrypt")}function getAlgorithm(e){return jQuery.element(e,"algorithm").val()}function getMode(e,t){return jQuery("input[name="+jQuery.id(e,t+"mode")+"]:checked").val()}function changeMode(e,t,r){arguments.length<3&&(r=getMode(e,t));var n=jQuery.element(e,t+"mode").data("mode")||"text";jQuery.element(e,t+r).prop("checked",!0),jQuery.element(e,t+"mode").data("mode",r);var a=jQuery.element(e,t);a.val(convert(a.val()).from(n).to(r)),a.toggleClass("text-monospace","hex"==r)}function convertEditor(e,t){var r=jQuery.element(e,t);r.val(convert(r.val()).to(getMode(e,t)))}function toggleCompare(e,t){arguments.length<2&&(t=e,e=!jQuery("#step"+steps.algorithm+"-2:visible").length),jQuery("#compare i").removeClass("fa-plus-circle fa-minus-circle").addClass("fa-"+(e?"minus":"plus")+"-circle"),jQuery("#compare a").text(e?"Hide the comparison tab.":"Add another tab to compare."),jQuery("#step"+steps.algorithm+"-2").revealOrConceal(e,t),e?stepInput(2,steps.algorithm):toggleStep(2,steps.algorithm,!1,t)}function toggleStep(e,t,r,n){r&&"string"!=typeof r?(jQuery.element(e,t+1,"step").reveal(n),jQuery.element(e,t+1,"dummy").conceal(),jQuery("#help"+(t+1)).reveal(n),stepInput(e,t+1)):(jQuery('div[id^="step"][id$="-'+e+'"]:'+(r||"gt")+"("+(t-1)+")").conceal(n).promise().done(function(){jQuery('div[id^="dummy"][id$="-'+e+'"]:'+(r||"gt")+"("+(t-1)+")").reveal()}),jQuery('div[id^="help"]:'+(r||"gt")+"("+Math.max(t-1,jQuery('div[id^="step"][id$="-'+(e%2+1)+'"]:visible').length-1)+")").conceal(n))}function toggleParameters(tab,algorithm,animate){var parameters=jQuery.parameter(tab,algorithm,!0);(parameters=jQuery.parameter(tab,algorithm,!0)).length?(animate=jQuery.parameter(tab).filter(":visible").length&&animate,jQuery.parameter(tab,!0).conceal(animate).promise().done(function(){parameters.each(function(){var parameter=jQuery(this).find("[data-value]:input"),value;!parameter.val()&&(value=parameter.data("value"))&&(/(.*)$/i.test(value)&&jQuery.isFunction((value=eval(value)).promise)?value.then(function(e){parameter.val(e)}):parameter.val(value))}).reveal(animate)})):toggleStep(tab,steps.parameters,"eq",animate)}function toggleHelp(e,t,r){var n={help:'div[id^="help"]',more:"button",reveal:'[data-help="all"], [data-help="'+t+'"]',conceal:'[data-help][data-help!="all"][data-help!="'+t+'"]'};jQuery.when.apply(this,[jQuery(n.conceal).conceal(r).promise()].concat(jQuery(n.help).map(function(){return jQuery(this).children(n.reveal).filter(":gt(2)").stop().conceal(r).promise()}))).done(function(){jQuery(n.help).each(function(){var e=jQuery(this);e.children(n.reveal).filter(":lt(3)").reveal(r),e.children(n.more).revealOrConceal(!!e.children(n.reveal).filter(":gt(2)").length,r)})})}function showMore(e){jQuery("#help"+e).children("button").conceal(!0).end().children('[data-help="all"], [data-help="'+getAlgorithm()+'"]').reveal(!0)}function stepInput(e,t){var r=!1,n=getAlgorithm(e);switch(t){case steps.algorithm:toggleParameters(e,n,!0),toggleHelp(e,n,!0),r=!!n;break;case steps.input:if((r=!!jQuery.element(e,"input").val())&&!jQuery.parameter(e,n,!0).length)return void stepInput(e,t+1);break;case steps.parameters:r=jQuery.parameter(e,n).reduce(function(e){return e&&!!jQuery(this).val()},!0);break;case steps.execute:r=!!jQuery.element(e,"output").val();break;case steps.output:r=!0}toggleStep(e,t,r,!0)}function encryptDecrypt(e){var t=jQuery.element(e,"encrypt").prop("checked");changeMode(e,"output","dec"!=getMode(e,"input")?t?"hex":"text":"dec"),jQuery.element(e,"output").val("01 02")}