/*!
 * Crypto Exhibit v1.0.0-alpha (http://www.crypto-exhib.it)
 * Copyright 2018 Mannheim University of Applied Sciences, Kristian Kraljic
 * Licensed under GPL-3.0-or-later
 */
var forge=require("node-forge"),BigInteger=forge.jsbn.BigInteger;function convert(n){"functions"in convert||(convert.functions={hex:{dec:function(e){return new BigInteger(e.replace(/ /g,String()),16).toString()},text:function(e){return forge.util.hexToBytes(e.replace(/[^0-9A-F]/gi,String()))}},dec:{hex:function(e){return convert(new BigInteger(e).toString(16)).to("hex")},text:function(e){return convert(e).from("dec").to("hex","text")}},text:{hex:function(e){return convert(forge.util.bytesToHex(e)).to("hex")},dec:function(e){return convert(e).from("text").to("hex","dec")}},false:{hex:function(e){return e.replace(/[^0-9A-F]/gi,String()).replace(/(.{2})/g,"$1 ").trim().toUpperCase()},dec:function(e){return e.replace(/[^0-9]/g,String()).trim()},text:function(e){return e}}});var t=function(r){return{to:function(){return jQuery.each(arguments,function(e,t){r!=t&&(n=convert.functions[r][t](n),r=t)}),n}}};return{from:function(e){return t(e)},to:t(!1).to}}exports.limitedScopeEval=function(){for(name in arguments[1]||{})eval("var "+name+" = arguments[1][name];");return eval(arguments[0])},exports.convert=convert,exports.randomBytes=function(e){return convert(forge.random.getBytesSync(e)).from("text").to("hex")},exports.randomPrime=function(e){return jQuery.Deferred(function(r){forge.prime.generateProbablePrime(e,function(e,t){e?r.reject(e):r.resolve(t.toString())})}).promise()};